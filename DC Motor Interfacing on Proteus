//DC motor Interfacing on proteus
#include <reg51.h>

// Motor connections
sbit motor_pin1 = P1^0;
sbit motor_pin2 = P1^1;

// Button input
sbit button_reverse = P2^0;

// Motor direction flag
bit motor_direction = 0;

// Simple delay
void delay(unsigned int time) {
    unsigned int i, j;
    for(i = 0; i < time; i++)
        for(j = 0; j < 1275; j++);
}

// Long delay to simulate low speed (PWM-like)
void low_speed_delay(unsigned int time) {
    unsigned int i, j;
    for(i = 0; i < time; i++)
        for(j = 0; j < 50000; j++); // moderate delay
}

void main() {
    // Initially, motor moves forward
    motor_pin1 = 1;
    motor_pin2 = 0;

    while(1) {
        // Check for button press (active low)
        if(button_reverse == 0) {
            delay(50); // debounce delay
            while(button_reverse == 0); // wait till release
            motor_direction = !motor_direction; // toggle direction
        }

        // Control motor direction
        if(motor_direction == 1) {
            motor_pin1 = 0;
            motor_pin2 = 1; // Reverse
        } else {
            motor_pin1 = 1;
            motor_pin2 = 0; // Forward
        }

        // Simulate low speed (turn ON and OFF alternately)
        low_speed_delay(10);  
        motor_pin1 = 0;
        motor_pin2 = 0;  // Motor OFF
        low_speed_delay(10);
    }
}
